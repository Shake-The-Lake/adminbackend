version: "3.8"

services:
  frontend:
    image: ghcr.io/shake-the-lake/adminfrontend:main
    ports:
      - 80:80
    depends_on:
      - backend
  backend:
    build: .
    ports:
      - "8080:8080"
    environment:
      - SERVER_PORT=8080
      - SERVER_PATH=/api
      - SPRING_DATASOURCE_URL=jdbc:postgresql://db:5432/shakethelake
      - SPRING_DATASOURCE_USERNAME=shakethelake
      - SPRING_DATASOURCE_PASSWORD=shakethelake
      - SPRING_DATASOURCE_DRIVER_CLASS_NAME=org.postgresql.Driver
      - SPRING_APPLICATION_JSON={"springdoc":{"swagger-ui":{"default-models-expand-depth":-1}}}
      - SPRING_JPA_DATABASE_PLATFORM=org.hibernate.dialect.PostgreSQLDialect
      - SPRING_JPA_GENERATE_DDL=true
      - SPRING_JPA_HIBERNATE_DDL_AUTO=update
      - SPRING_APPLICATION_SHAKETHELAKE_FIREBASE_PRIVATE_KEY=ewogICJ0eXBlIjogInNlcnZpY2VfYWNjb3VudCIsCiAgInByb2plY3RfaWQiOiAic2hha2V0aGVsYWtlIiwKICAicHJpdmF0ZV9rZXlfaWQiOiAiNmE2MTAwMTMyZWJiNmM0MTFhM2I0MzNkZTNjZDg0OGU3OTYwMTVlZSIsCiAgInByaXZhdGVfa2V5IjogIi0tLS0tQkVHSU4gUFJJVkFURSBLRVktLS0tLVxuTUlJRXZnSUJBREFOQmdrcWhraUc5dzBCQVFFRkFBU0NCS2d3Z2dTa0FnRUFBb0lCQVFDS2FNS0pVNE9EczV3eVxuSHpOS1pmR0k4VzY1dmxESjliRlVrbHJ6aWNPS3p1Vk93UGtxaDE2RklGMUlWYXdLTEJCTkozTlhuREpBa1crOVxuUlZuTGY4K1BhSmdTM2hIYWFzMktLVFZGUzlwRFdSbVBoVDlWYUFaUlIwdDJSbCtpYkFlamlwZHVhZmZUTFhMN1xudkVMdlNmUmZ2d2QrZFptUlNuaXMxUTFHbWFST1d0eUtkU3U3Szd4MUpnYnVSbTI0enh0bWpVVmRqa3lUcGZLN1xuZDYxZUlabGd3OWFKSStOK2s4R3VpYkdvZU5nSUVGdkNoT2xDU3hUQVpzQkZNUVRvZHZFR3dsTWxqR244U3pUTVxuSHhXT25jSld3WXFaajBGN2NNbWxVallmM3dsYk5zUkU4Rjk5S29CVk45Z3UwNzNCQlU4R1R1eE1GMDA3S0NQTFxuQ1VuQlpiV3hBZ01CQUFFQ2dnRUFCd21mdXlCeXhXU0JnSnV0SmFjNGRGMXMweTlYNzZYeFR1YmNicW5LaGwxQlxuNC9yTVRJOGFwVytkYUtFNURNRWI4TlZjd0RlWUowZngxOXlON2RyTlJxb2pnZUdXWkM0R0xwUk04ZTJpL3VYSlxuMXI0b1o4OEEwN3NKblcxamZWaHJmTU4rTXNvNjlIc1pENjlkVXFvV3JiUGlsVm0wemRJODM3SmJVUU84eXRKUlxuSXFJMWNtWC9nMlMzNzl5N2VpS3NXeXJFWEJhR21xd2xaMUxvVlcyRk84ZTVoaEZyMi80QVBoUDE4Nk5adGNjOVxudWpEZVZDZGNTbEJkODQwVEdBV2xuZ0VYZ1ltZzBCUzh2U3V0cklMRDhTSXhmb1pNS3ZxYm1YdC9yWTRiVjF6RVxuSGtBaytOd2xDL2N6czVPUENXYzNDSFpvUVhIVWpBL2wrc1QycUNJN3dRS0JnUURBM09QSEtKM2FCcE1pTllta1xuc1FQekJxVVBjTlBSV1hYbU9FVXNGS3AwZkdRd2U0dzNXR3NPSTFsT0U2MnZVdWdhNzQ4UTQ3V0MzZWQ2QkNMN1xuZ0NyWXJHcFVKdUQ1SlJ1Mm5qbFdDWGZxa0hXb2ZTZ0pXQUdCcnJ3N3ZMTU9KMkVQTXJSSDBiSEtXbzRhS0d5UlxuV0praHFaTHFQVE9BSmRaUUJuZEI5QzdCUVFLQmdRQzN1RkRsNjdBclFtV1pqR1I0UXJyTXZJY1BlS1cwZlNKelxuTjk4MkgzemRXeHVMbFlmM3RpNGpSYzFBTVF4ems2SGZ3TTduWE4xOWx3Wnh1bWFBbDNqdldlUUh1VG11Y2xKdFxuaFR6ZEVYZENuckEwZDk0MWZhTlFPK2xhVnpRd3JJekhma0hiT0EzdHM0czAzVER6alVPZFRmTlJrVWJiSjdHNlxuaExoVktrQm9jUUtCZ1FEQTJxRXl2OXpJN2hZbStSNUFmM29SaEsxOWVUZDJlbHk0NzcvTHlvYUFvUHFXdUpTSFxucTNTeDJJc3UxZUt5Rk5kZ1IvanB6S251eVBMMVFqbXhBSUxYMCtFbmNSRTZVZThhZDdHaDVTbnlkcTRRNDhZclxuUWNPUDZDajJHMFY1ZTh0RXBWRTlGK1VQRWVwVEllVWVtbGZXSDNsM25lZG4xMjRzNjZwSlcyRjlnUUtCZ1FDblxuc2tGOXJXWHdCcnBRcnpxaUgxNzlOUFVmWlNQMEhPak9QT2l0TVk2N1NzZFk0UlBzUTBuWC9vWDhtd2pma3BtR1xuY1Nzck9yUWVTRFdrcDkyYWNTajlhWkxnamUwZDA5SnpqOVBmZ21yV3o1ek5OOEVJR0hkeTdFenpubmZRR2lDaVxubEJldTczcWZSMnpBdzBwRWRlU0srTFVwOWk2MEtvWnJWMndlcU9PRHNRS0JnQkpqenZSVzZYV1RZaGd2Nk9TZVxuTXZHcDJnSTVWSUU3WmVpVVFpVjgvUGFEalBKK29JaTJkaFBCUTVEN2czQUt1SWVKN0tPdXRpdUF2NEZKNThzelxuR0RkakRmbnpqR3hVaGErdSs3Q1VqZmRsR3duR0NhYWFhMTA1V3RLVDRZU1M3blFqcVNBaXVJNmRvZU1RSXBHQ1xuWHFtcVRZLzNibm0yTnpFellsMjRaVUJLXG4tLS0tLUVORCBQUklWQVRFIEtFWS0tLS0tXG4iLAogICJjbGllbnRfZW1haWwiOiAiZmlyZWJhc2UtYWRtaW5zZGstMjFuM3lAc2hha2V0aGVsYWtlLmlhbS5nc2VydmljZWFjY291bnQuY29tIiwKICAiY2xpZW50X2lkIjogIjEwMDA0NjcxNDQ2ODc3MjAxNDIyNCIsCiAgImF1dGhfdXJpIjogImh0dHBzOi8vYWNjb3VudHMuZ29vZ2xlLmNvbS9vL29hdXRoMi9hdXRoIiwKICAidG9rZW5fdXJpIjogImh0dHBzOi8vb2F1dGgyLmdvb2dsZWFwaXMuY29tL3Rva2VuIiwKICAiYXV0aF9wcm92aWRlcl94NTA5X2NlcnRfdXJsIjogImh0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL29hdXRoMi92MS9jZXJ0cyIsCiAgImNsaWVudF94NTA5X2NlcnRfdXJsIjogImh0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL3JvYm90L3YxL21ldGFkYXRhL3g1MDkvZmlyZWJhc2UtYWRtaW5zZGstMjFuM3klNDBzaGFrZXRoZWxha2UuaWFtLmdzZXJ2aWNlYWNjb3VudC5jb20iLAogICJ1bml2ZXJzZV9kb21haW4iOiAiZ29vZ2xlYXBpcy5jb20iCn0=
      - TZ=Europe/Berlin
    depends_on:
      - db
  db:
    image: postgres:latest
    environment:
      - TZ=Europe/Berlin
      - POSTGRES_DB=shakethelake
      - POSTGRES_USER=shakethelake
      - POSTGRES_PASSWORD=shakethelake
    ports:
      - "5432:5432"
